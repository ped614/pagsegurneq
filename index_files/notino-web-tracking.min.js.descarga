this["notino-web-tracking"]=this["notino-web-tracking"]||{},this["notino-web-tracking"].min=this["notino-web-tracking"].min||{},this["notino-web-tracking"].min.js=function(e){"use strict";var t;!function(e){e.ADD="add",e.REMOVE="remove"}(t||(t={}));var n,o,i;!function(e){e.available="true",e.hidden="hidden",e.notAvailable="false",e.timeout="timeout"}(n||(n={})),function(e){e.active="active",e.inactive="inactive",e.available="available",e.notAvailable="false"}(o||(o={})),function(e){e.cart="Cart",e.clickAndCollect="ClickAndCollect",e.giftcard="GiftCard",e.unknown="NULL"}(i||(i={}));var r="page:viewed",a="page:viewed:detail",c="page:viewed:checkout",d="page:viewed:products",u="tracking:event:generic",v="product:clicked",l="product:viewed",s="promo:clicked",p="promo:viewed",m="product:cart:added",f="product:clickandcollect:added",g="product:cart:removed",y="page:init:additional",C="command:reset:datalayer",b="command:reset:ecommerce",h=function(){},w=function(e){return window.location.origin+"/api/tracking/web/"+e},A=function(e,t){return"eventName"===e?void 0:t};function k(e,t,n,o){return new Promise((function(i,r){var a=new XMLHttpRequest;a.open("POST",e,!0),a.setRequestHeader("Content-Type",t),a.onload=function(){var e=!o||a.response.substring(0,o.length)===o;this.status>=200&&this.status<300&&e?i(a.response):r({status:this.status,requestText:n,responseText:a.responseText})},a.onerror=function(){r({status:this.status,requestText:n})},a.send(n)}))}var L=function(e,t){return k(w(String(e)),"application/json",JSON.stringify(t),null)},I=function(e){(function(){return k(w(e.eventName),"application/json",function(e){return JSON.stringify(e,A)}(e),null)})().then((function(){return h})).catch((function(){return h}))};function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function D(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}var V,O,E,T,P=function(e){return parseFloat(Number(e.value/(100+e.tax)*100).toFixed(2))},F=function(e){var t,n,o,i=e.product,r=e.quantity,a=e.list,c=i.name||((i.brand?i.brand+" ":"")+(i.collection?""+i.collection:"")).trim(),d=null!=(t=i.quantity)?t:r,u=a&&i.isSponsored?a+"_sponsored":a;return N({id:i.productCode,name:c,variant:i.variant,productLine:c},void 0!==i.isAvailable&&{availability:(n=i.isAvailable,o=i.hasWatchdog,!n&&o?"watchdog":n?"true":"false")},{isClickAndCollect:Boolean(i.isClickAndCollect)},i.productId&&{idRtbHouse:i.productId},Object.prototype.hasOwnProperty.call(i,"isHealthKind")&&{isHealthKind:i.isHealthKind},i.isForbiddenToOffer&&{isForbiddenToOffer:i.isForbiddenToOffer},i.price&&{price:P(i.price),fullPrice:i.price.value},i.brand&&{brand:i.brand},i.position&&{position:i.position},i.modifaceAvailable&&{modifaceAvailable:i.modifaceAvailable},i.engravingAvailable&&{engravingAvailable:i.engravingAvailable},i.tryItFirstAvailable&&{tryItFirstAvailable:i.tryItFirstAvailable},i.loyaltyDiscount&&{loyaltyDiscount:i.loyaltyDiscount},{dimension53:i.giftAvailable},u&&{list:u},i.campaignId&&{campaignId:i.campaignId},d&&{quantity:d},i.additionalProperties)},x=function(e){return N({},F(e),{category:(t=e.product,[t.kind||"NULL",t.category||"NULL",t.subCategory||"NULL",t.type||"NULL"]),cartType:e.cartType||i.unknown});var t},R=function(e,t,n){return{ecommerce:{currencyCode:n,impressions:e.map((function(e){return F({product:e,list:t})}))}}},q=function(e){window.dataLayer&&window.dataLayer.push(e)},j=function(e){var t=e.googleTagParams,n=e.ecommerceData;q(N({},t&&{google_tag_params:{ecomm_pagetype:t.pageType,ecomm_prodid:t.productId,pname:t.productName,ecomm_totalValue:t.totalValue,pcat:t.productCategory}},n&&{ecommerce:n}))},_=function(e){var t=e.eventCategory,n=e.eventAction,o=e.eventLabel,i=void 0===o?void 0:o,r=e.eventNonInteraction,a=void 0===r?void 0:r,c=e.eventValue;q({event:"ga.event",eventCategory:t,eventAction:n,eventNonInteraction:a,eventLabel:i,eventValue:void 0===c?void 0:c})};!function(e){e.ADD="add",e.REMOVE="remove"}(T||(T={}));var M=((V={})[T.ADD]="ec.addToCart",V[T.REMOVE]="ec.removeFromCart",V),U=((O={})[T.ADD]="AddToCart",O[T.REMOVE]="RemoveFromCart",O),H=((E={})[T.ADD]="add",E[T.REMOVE]="remove",E),S=function(e){var t,n=e.action,o=e.product,r=e.quantity,a=void 0===r?1:r,c=e.currencyCode,d=e.list,u=e.cartType,v=void 0===u?i.unknown:u,l=e.category,s=void 0===l?"Product":l,p=e.actionName,m=void 0===p?H[n]:p,f=e.event,g=void 0===f?M[n]:f,y=e.eventAction,C=void 0===y?U[n]:y,b=e.eventNonInteraction,h=void 0===b?void 0:b;q({event:g,eventAction:C,eventLabel:o.productCode,eventCategory:s,eventNonInteraction:h,eventValue:o.price?parseFloat((P(o.price)*a).toFixed(2)):void 0,ecommerce:(t={currencyCode:c},t[m]=N({},d?{actionField:{action:m,list:d}}:{actionName:m},{products:[x({product:o,quantity:a,cartType:v})]}),t)})},W=function(e){S(N({action:T.REMOVE},e))},B=function(e){var t=e.type,n=e.title,o=e.path,i=e.description,r=e.params,a=void 0===r?{}:r;q(N({event:"ga.PageView",page:N({path:o||window.location.pathname,title:n||document.title},t&&{type:t},i&&{description:i})},a))},K=["currencyCode","products"],G=function(e){var t=e.currencyCode,n=e.products,o=D(e,K);B(N({params:{ecommerce:{currencyCode:t,detail:{products:n.map((function(e){return F({product:e})}))}}}},o))},J=["products","currencyCode","list"],X=function(e){var t=e.products,n=e.currencyCode,o=e.list,i=void 0===o?"":o,r=D(e,J);B(N({},r,{params:R(t,i,n)}))},z=["step","stepName","revenue","revenueWithoutDiscount","tax","products","list"],Q=function(e){var t=e.step,n=e.stepName,o=e.revenue,i=e.revenueWithoutDiscount,r=e.tax,a=e.products,c=e.list,d=D(e,z);B(N({params:N({},a.some((function(e){return Boolean(e.productId)}))&&{ID_RTBhouse:a.map((function(e){return e.productId}))},{ecommerce:{checkout:{actionField:{step:t,stepName:n,revenue:o,revenueWithoutDiscount:i,tax:r},products:a.map((function(e){return x({product:e,list:c})}))}}})},d))},Y=function(e){var t=e.product,n=e.currencyCode,o=e.list,i=e.eventAction,r=void 0===i?"ProductListClick":i,a=e.eventCategory,c=void 0===a?"Product List":a,d=o&&t.isSponsored?o+"_sponsored":o;q({event:"ec.click",eventAction:r,eventCategory:c,eventNonInteraction:void 0,eventLabel:t.productCode,eventValue:t.price?P(t.price):void 0,ecommerce:{currencyCode:n,click:{actionField:{list:d},products:[F({product:t,list:o})]}}})},Z=function(){q({eventCategory:void 0,eventAction:void 0,eventLabel:void 0,eventValue:void 0,eventNonInteraction:void 0,page:void 0,ecommerce:void 0})},$=function(){q({ecommerce:{impressions:void 0}})},ee=function(e){var t=e.products,n=e.list,o=e.currencyCode,i=e.eventAction,r=void 0===i?"ProductListView":i,a=e.eventCategory,c=void 0===a?"Product List":a,d=e.eventNonInteraction,u=void 0===d?void 0:d;n&&t.length>0&&($(),q(N({event:"ec.productImpressions",eventNonInteraction:u,eventAction:r,eventCategory:c,eventLabel:n,eventValue:t.length},R(t,n,o))))},te=function(e){var t=e.promoItem,n=e.currencyCode;q({event:"ec.promoClick",eventAction:"PromotionClick",eventCategory:"Promotion",eventLabel:t.id,eventValue:void 0,eventNonInteraction:void 0,ecommerce:{currencyCode:n,promoClick:{promotions:[t]}}})},ne=function(e){var t=e.promoItems,n=e.currencyCode;q({event:"ec.promoView",eventAction:"PromotionView",eventCategory:"Promotion",eventLabel:void 0,eventValue:void 0,eventNonInteraction:!0,ecommerce:{currencyCode:n,promoView:{promotions:t}}})},oe=function(e){S(N({action:T.ADD,eventAction:"AddToClickAndCollect"},e))};var ie=function(e){q(e)};var re,ae;return"undefined"!=typeof document&&((re={})[m]=function(e){S(N({action:T.ADD},e))},re[f]=oe,re[a]=G,re[u]=_,re[y]=j,re[d]=X,re[r]=B,re[v]=Y,re[l]=ee,re[s]=te,re[p]=ne,re[g]=W,re[C]=Z,re[b]=$,re[c]=Q,ae=re,Object.entries(ae).forEach((function(e){var t=e[0],n=e[1];document.addEventListener(t,(function(e){var t=e.detail;return t&&n(t)}))})),document.addEventListener("ga4-tracking-event",(function(e){var t=e.detail;return t&&ie(t)})),document.addEventListener("exponea-event",(function(e){var t=e.detail;return t&&I(t)})),window.trackingEvents||(window.trackingEvents={ViewItem:function(e){return L("view/detail",e)},CartUpdate:function(e){return L("cart/update",e)},WishlistUpdate:function(e){return L("wishlist/update",e)}})),e.trackGa4Event=ie,e}({});
